<!DOCTYPE html>
<html lang="en">

<!-- ============================================================================
     HOME PAGE - Audio Design Studios
     Main landing page with highlights, services, and contact
     ============================================================================ -->

<head>
  <!-- Meta Information -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Audio Design Studios – Karter G. Brown</title>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="styles.css?v=1765389528" />
</head>

<body>
  <!-- ========================================================================
       SITE HEADER - Navigation
       ======================================================================== -->
  <header class="site-header">
    <a href="matrix.html" class="logo" style="text-decoration: none;">Audio Design Studios</a>
    <nav class="nav">
      <a href="index.html">Home</a>
      <a href="portfolio.html">Portfolio</a>
      <a href="about.html">About</a>
      <a href="music.html">Music</a>
    </nav>
  </header>

  <!-- ========================================================================
       MAIN CONTENT
       ======================================================================== -->
  <main>
    
    <!-- ======================================================================
         SECTION 1: Hero Image Banner
         ====================================================================== -->
    <section class="env-image env-home"></section>

    <!-- ======================================================================
         SECTION 2: Services Grid (3 Cards)
         ====================================================================== -->
    <section id="services" class="section section-alt">
      <div class="grid">
        <div class="card">
          <h3>Sound Design</h3>
          <p>Custom SFX, soundscapes, and detailed sound editing for film, animation, and games.</p>
        </div>
        <div class="card">
          <h3>Mixing & Mastering</h3>
          <p>Clean, balanced mixes for music, podcasts, trailers, and cinematic content.</p>
        </div>
        <div class="card">
          <h3>Original Music</h3>
          <p>Score cues, thematic motifs, and production music tailored to your project.</p>
        </div>
      </div>
    </section>
    
    <!-- ======================================================================
         SECTION 4: Before & After Mixing/Mastering Comparison
         ====================================================================== -->
    <section class="section before-after-section">
      <h2>Before & After Mixing and Mastering</h2>
      <p class="centered-text">Compare the raw recording with the final mixed and mastered version. Use the toggle to switch between versions in real time.</p>
      
      <div class="ba-single-player">
        <!-- Track Title -->
        <div class="ba-track-title">Near Wild Heaven (Cover)</div>

        <!-- Toggle Section: Before - Toggle - After -->
        <div class="ba-toggle-section">
          <span class="ba-toggle-label ba-toggle-before">Before</span>
          <label class="ba-toggle-switch">
            <input type="checkbox" id="baToggle">
            <span class="ba-toggle-slider"></span>
          </label>
          <span class="ba-toggle-label ba-toggle-after">After</span>
        </div>

        <!-- Player Controls -->
        <div class="ba-player-controls">
          <button class="play-btn ba-play-btn" id="baPlayBtn" aria-label="Play">▶</button>
          <div class="ba-progress-container">
            <div class="ba-progress-wrap" id="baProgressWrap">
              <div class="ba-progress-fill" id="baProgressFill"></div>
              <div class="ba-scrubber" id="baScrubber"></div>
            </div>
          </div>
        </div>

        <!-- Hidden Audio Elements -->
        <audio id="beforeAudio" src="highlights/B_NearWildHeaven_12072025.mp3" preload="auto"></audio>
        <audio id="afterAudio" src="highlights/A_NearWildHeaven_12072025.mp3" preload="auto"></audio>
      </div>
    </section>
    
    <!-- ======================================================================
         SECTION 3: Highlights Hero (3-Column Layout)
         Left: Album art | Center: Title, description, cycling word | Right: Headshot
         Bottom: Track players spanning full width
         ====================================================================== -->
    <section id="portfolio" class="hero hero-highlights-3col">
      <!-- Left Column: Album Art -->
      <div class="hero-left-highlights">
        <div class="album-cover-centered" aria-hidden="true">
          <picture>
            <source media="(min-width:1200px)" srcset="highlights/staticcurrents2000.webp">
            <source media="(min-width:720px)" srcset="highlights/staticcurrents1400.webp">
            <img src="highlights/staticcurrents800.webp" alt="Highlights album cover" />
          </picture>
        </div>
      </div>

      <!-- Center Column: Contact Form -->
      <div class="hero-center-highlights">
        <div class="contact-wrapper">
          <h1>Get In Touch</h1>
          <p>Send a message and I'll get back to you with next steps.</p>
          <form class="contact-form" action="https://formspree.io/f/xjknowjb" method="POST">
            <input type="text" name="name" placeholder="Your Name" required />
            <input type="email" name="email" placeholder="Your Email" required />
            <textarea name="message" placeholder="Describe your project..." required></textarea>
            <button type="submit" class="btn">Send Message</button>
          </form>
        </div>
      </div>

      <!-- Right Column: Headshot -->
      <div class="hero-right-highlights">
        <div class="headshot-wrapper-portrait">
          <picture>
            <source media="(min-width:1200px)" srcset="Photos/headshot2_2000.webp">
            <source media="(min-width:720px)" srcset="Photos/headshot2_1400.webp">
            <img src="Photos/headshot2_800.webp" alt="Karter Brown Headshot" class="headshot" />
          </picture>
        </div>
      </div>

      <!-- Full Width Bottom: Track Players -->
      <div class="hero-tracks-highlights">
        <div class="playlist" id="playlist">
          <!-- Track rows will be injected via JavaScript -->
        </div>
      </div>
    </section>

    <!-- ======================================================================
         SECTION 5: Matrix Animation (Green Musical Notes)
         ====================================================================== -->
    <a href="portfolio.html" class="matrix-link">
      <section class="matrix-section">
        <div class="matrix-terminal" id="matrixTerminal"></div>
      </section>
    </a>
  </main>

  <!-- ========================================================================
       SITE FOOTER - Contact Information
       ======================================================================== -->
  <footer class="site-footer">
    <div class="footer-content">
      <h2>Contact</h2>
      <p>Email: <a href="mailto:music@kartergbrown.com">music@kartergbrown.com</a></p>
      <p class="footer-copy">© <span id="year"></span> Audio Design Studios. All rights reserved.</p>
    </div>
  </footer>

  <!-- ========================================================================
       SCRIPTS
       ======================================================================== -->
  
  <!-- Content Configuration & Dynamic Loader (Edit text/styles here) -->
  <script src="content.js?v=1765389528"></script>

  <!-- ========================================================================
       Highlights Mini-Players (3 Independent Players)
       ======================================================================== -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const highlights = [
        { id: 'track1', title: 'Nearly Ever', url: 'highlights/NearlyEver_FullMix.mp3' },
        { id: 'track2', title: 'The Revolt', url: 'highlights/therevolt.mp3' }
      ];

      const highlightsContainer = document.getElementById('playlist');
      let activeDrag = null; // Shared drag state for all players

      // Create individual highlight track row with mini-player
      function createHighlightRow(track) {
        const row = document.createElement('div');
        row.className = 'track-row';

        const header = document.createElement('div');
        header.className = 'track-header';

        const num = document.createElement('div');
        num.className = 'track-number';
        num.textContent = track.id.replace('track', '');

        const btn = document.createElement('button');
        btn.className = 'play-btn';
        btn.setAttribute('aria-label', `Play ${track.title}`);
        btn.textContent = '▶';

        const title = document.createElement('div');
        title.className = 'track-title';
        title.textContent = track.title;

        const progressContainer = document.createElement('div');
        progressContainer.className = 'highlight-progress-container';
        
        const progressWrap = document.createElement('div');
        progressWrap.className = 'highlight-progress-wrap';
        
        const progressFill = document.createElement('div');
        progressFill.className = 'highlight-progress-fill';
        progressFill.style.width = '0%';
        
        const scrubber = document.createElement('div');
        scrubber.className = 'highlight-scrubber';
        
        progressWrap.appendChild(progressFill);
        progressWrap.appendChild(scrubber);
        progressContainer.appendChild(progressWrap);

        const audio = new Audio(track.url);

        header.appendChild(num);
        header.appendChild(btn);
        header.appendChild(title);

        row.appendChild(header);
        row.appendChild(progressContainer);

        btn.addEventListener('click', () => {
          if (audio.paused) {
            audio.play();
          } else {
            audio.pause();
          }
        });

        audio.addEventListener('play', () => { btn.textContent = '⏸'; });
        audio.addEventListener('pause', () => { btn.textContent = '▶'; });
        audio.addEventListener('ended', () => { 
          btn.textContent = '▶'; 
          progressFill.style.width = '0%';
          scrubber.style.left = '0%';
        });

        audio.addEventListener('timeupdate', () => {
          const pct = audio.duration ? (audio.currentTime / audio.duration) * 100 : 0;
          progressFill.style.width = `${pct}%`;
          scrubber.style.left = `${pct}%`;
        });

        // Drag and click to seek
        const updateSeek = (e) => {
          const rect = progressWrap.getBoundingClientRect();
          const pct = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
          if (audio.duration) {
            audio.currentTime = pct * audio.duration;
          }
        };

        progressWrap.addEventListener('mousedown', (e) => {
          e.preventDefault();
          activeDrag = { element: progressWrap, update: updateSeek };
          updateSeek(e);
          progressWrap.style.cursor = 'grabbing';
        });

        progressWrap.addEventListener('click', (e) => {
          if (!activeDrag) updateSeek(e);
        });

        highlightsContainer.appendChild(row);
      }

      // Generate all highlight rows
      highlights.forEach(createHighlightRow);
      
      // Global drag handlers for progress scrubbing
      document.addEventListener('mousemove', (e) => {
        if (activeDrag) {
          e.preventDefault();
          activeDrag.update(e);
        }
      });
      
      document.addEventListener('mouseup', () => {
        if (activeDrag) {
          activeDrag.element.style.cursor = 'pointer';
          activeDrag = null;
        }
      });


    });
  </script>

  <!-- ========================================================================
       Before & After Mixing/Mastering Toggle Player
       New approach: Both tracks play simultaneously, toggle controls muting
       ======================================================================== -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const beforeAudio = document.getElementById('beforeAudio');
      const afterAudio = document.getElementById('afterAudio');
      const baPlayBtn = document.getElementById('baPlayBtn');
      const baToggle = document.getElementById('baToggle');
      const baProgressWrap = document.getElementById('baProgressWrap');
      const baProgressFill = document.getElementById('baProgressFill');
      const baScrubber = document.getElementById('baScrubber');

      let activeDrag = null;
      let isPlaying = false;

      // Initialize: Before is audible, After is muted
      beforeAudio.muted = false;
      afterAudio.muted = true;

      // Utility: Wait for audio to be ready to play
      function waitForReady(audio) {
        return new Promise(resolve => {
          if (audio.readyState >= 3) {
            resolve();
          } else {
            audio.addEventListener('canplaythrough', resolve, { once: true });
          }
        });
      }

      // Play/Pause button - controls BOTH audio elements
      baPlayBtn.addEventListener('click', async () => {
        if (isPlaying) {
          // Pause both
          beforeAudio.pause();
          afterAudio.pause();
          baPlayBtn.textContent = '▶';
          isPlaying = false;
        } else {
          // Wait for both to be ready, then play simultaneously
          baPlayBtn.textContent = '…';
          try {
            await Promise.all([
              waitForReady(beforeAudio),
              waitForReady(afterAudio)
            ]);
            await Promise.all([
              beforeAudio.play(),
              afterAudio.play()
            ]);
            baPlayBtn.textContent = '⏸';
            isPlaying = true;
          } catch (e) {
            console.warn('play failed', e);
            baPlayBtn.textContent = '▶';
            isPlaying = false;
          }
        }
      });

      // Toggle switch - just swaps mute state
      baToggle.addEventListener('change', (e) => {
        if (e.target.checked) {
          // After is active (unmuted)
          beforeAudio.muted = true;
          afterAudio.muted = false;
          
          // Update label styling
          document.querySelector('.ba-toggle-before').style.opacity = '0.6';
          document.querySelector('.ba-toggle-before').style.fontWeight = '500';
          document.querySelector('.ba-toggle-after').style.opacity = '1';
          document.querySelector('.ba-toggle-after').style.fontWeight = '600';
        } else {
          // Before is active (unmuted)
          beforeAudio.muted = false;
          afterAudio.muted = true;
          
          // Update label styling
          document.querySelector('.ba-toggle-before').style.opacity = '1';
          document.querySelector('.ba-toggle-before').style.fontWeight = '600';
          document.querySelector('.ba-toggle-after').style.opacity = '0.6';
          document.querySelector('.ba-toggle-after').style.fontWeight = '500';
        }
      });

      // Use beforeAudio for progress tracking (both are synced)
      beforeAudio.addEventListener('timeupdate', () => {
        const pct = beforeAudio.duration ? (beforeAudio.currentTime / beforeAudio.duration) * 100 : 0;
        baProgressFill.style.width = `${pct}%`;
        baScrubber.style.left = `${pct}%`;
      });

      // Handle end of playback
      beforeAudio.addEventListener('ended', () => {
        baPlayBtn.textContent = '▶';
        baProgressFill.style.width = '0%';
        baScrubber.style.left = '0%';
        isPlaying = false;
      });

      // Progress bar scrubbing - seek both tracks
      const updateSeek = (e) => {
        const rect = baProgressWrap.getBoundingClientRect();
        const pct = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
        if (beforeAudio.duration) {
          const newTime = pct * beforeAudio.duration;
          beforeAudio.currentTime = newTime;
          afterAudio.currentTime = newTime;
        }
      };

      baProgressWrap.addEventListener('mousedown', (e) => {
        e.preventDefault();
        activeDrag = { element: baProgressWrap, update: updateSeek };
        updateSeek(e);
        baProgressWrap.style.cursor = 'grabbing';
      });

      baProgressWrap.addEventListener('click', (e) => {
        if (!activeDrag) updateSeek(e);
      });

      // Global drag handlers
      document.addEventListener('mousemove', (e) => {
        if (activeDrag) {
          e.preventDefault();
          activeDrag.update(e);
        }
      });
      
      document.addEventListener('mouseup', () => {
        if (activeDrag) {
          activeDrag.element.style.cursor = 'pointer';
          activeDrag = null;
        }
      });
    });
  </script>

  <!-- ========================================================================
       Matrix Terminal Effect (Green Musical Notes)
       ======================================================================== -->
  <script>
    const terminal = document.getElementById('matrixTerminal');
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    terminal.appendChild(canvas);
    
    const chars = '♩♪♫♬♭♮♯';
    let columns, drops, xPositions;
    
    function resize() {
      canvas.width = terminal.offsetWidth;
      canvas.height = terminal.offsetHeight;
      const fontSize = 18;
      const columnWidth = 35;
      columns = Math.floor(canvas.width / columnWidth);
      const totalWidth = columns * columnWidth;
      const offsetX = (canvas.width - totalWidth) / 2;
      drops = Array(columns).fill(0).map(() => Math.random() * -100);
      xPositions = Array(columns).fill(0).map((_, i) => offsetX + i * columnWidth + columnWidth / 2);
    }
    
    function draw() {
      ctx.fillStyle = 'rgba(20, 20, 20, 0.1)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      ctx.font = 'bold 18px Courier New';
      ctx.fillStyle = '#08ce18';
      
      for (let i = 0; i < drops.length; i++) {
        const char = chars[Math.floor(Math.random() * chars.length)];
        const x = xPositions[i];
        const y = drops[i] * 45;
        
        ctx.fillText(char, x, y);
        
        if (y > canvas.height && Math.random() > 0.95) {
        drops[i] = Math.random() * -100;
        const columnWidth = 28;
        const totalWidth = columns * columnWidth;
        const offsetX = (canvas.width - totalWidth) / 2;
        xPositions[i] = offsetX + i * columnWidth + columnWidth / 2 + Math.random() * 14 - 7;
        }
        drops[i] += 0.32;
      }
    }
    
    resize();
    window.addEventListener('resize', resize);
    setInterval(draw, 100);
  </script>

</body>
</html>
